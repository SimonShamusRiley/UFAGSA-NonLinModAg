<!DOCTYPE html>
<html lang="en"><head>
<script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/clipboard/clipboard.min.js"></script>
<script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/quarto-html/tabby.min.js"></script>
<script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/quarto-html/popper.min.js"></script>
<script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <meta name="author" content="Simon Riley, UF|IFAS Statistical Consulting Unit">
  <title>Non-Linear Modeling for Dose- and Rate-Response Studies in Agriculture</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/dist/theme/quarto.css">
  <link href="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Non-Linear Modeling for Dose- and Rate-Response Studies in Agriculture</h1>
  <p class="subtitle">An Introduction in R</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Simon Riley, UF|IFAS Statistical Consulting Unit 
</div>
</div>
</div>

</section>
<section class="slide level2">

<aside class="notes">
<ul>
<li><p>Hello, everyone! For those who don’t know me, my name is Simon Riley, I’m a PhD candidate in Agronomy and a data analyst with the IFAS Statistical Consulting Unit</p></li>
<li><p>In today’s workshop I’ll be introducing the use of non-linear models for dose- and rate-response studies in agriculture, and specifically how to work with such models using the <code>gnls()</code> function from the R package <code>nlme</code>. My hope is that everyone attending will leave having learned something, but I will also say that this workshop will be most useful for those who have already had at least one graduate-level course on statistics, and have at least a basic familiarity with R.</p></li>
<li><p>but before diving in, however, I have a few preliminaries to run through. First, for those of you who are not familiar with the IFAS SCU…</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="ufifas-statistical-consulting-unit" class="slide level2">
<h2>UF|IFAS Statistical Consulting Unit</h2>
<p>Open to everyone affiliated with IFAS</p>
<p>Provides <strong>free assistance</strong> with:</p>
<ul>
<li><p>Experimental design, including sample size &amp; power calculations</p></li>
<li><p>Data analysis, providing conceptual or applied guidance</p></li>
<li><p>Interpretation and reporting of results, including preparation of tables and figures</p></li>
</ul>
<p><u>Submit a consulting request at: <a href="https://bit.ly/3Goicy9" class="uri">https://bit.ly/3Goicy9</a></u></p>
<p><strong>Teams Page:</strong> useful articles, code snippits, place to ask general stats questions.</p>
<p><strong>Seminar Series:</strong> Basic, software agnostic introductions to methods, concepts and best practices in statistics. First Friday (usually) of every month @ 3 PM in 426 McCarty C and on Zoom.</p>
</section>
<section id="preface" class="slide level2">
<h2>Preface:</h2>
<aside class="notes">
<ul>
<li>Second, I want to briefly preface this presentation with some general guidance on why and how to use non-linear modeling</li>
</ul>
<ol type="1">
<li><p>…If your treatments, or one of your factors, consist of points along a continuum, we’re generally more interested in understanding an overall trend than differences in the response at specific values.</p></li>
<li><p>…Neither this nor point nor the last is an inviolable law, there are exceptions, but non-linear models are good tools to have at our disposal.</p></li>
<li><p>At the start of our analysis we often start small, fitting a model to just the data from one year, or location, or even one treatment, and this is not just OK its very prudent and can save you from much grief later on. But for our final analysis, we don’t want to be fitting 8 or 10 different versions of that small model. Instead we want to build out our model to accomodate the effects of year or location or treatment and fit one model to all of our data. This greatly facilitates later testing but even if your not interested in testing between the different factors, the larger sample size provides your estimates greater precision.</p></li>
<li><p>I strongly favor training on general purpose software, rather than more user-friendly but less flexible R packages, even if it implies a somewhat steeper learning curve. We all know that the data in tutorials is nothing like data in the wild, and sooner or later you’re likely to need that added flexibility. The general purpose software also often has the advantage of greater interoperability with other R packages. Note that I’m specifically refering to model fitting here - there are lots of useful packages which provide additional functionality and extend the usefulness of general purpose modeling packages like <code>nlme</code>.</p></li>
<li><p>Whatever your baseline level of frustration with R is, expect it double when starting out with nonlinear modeling. If these are methods you expect to need or use in the future, its good to get some practice in when you have time and patience.</p></li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<ol type="1">
<li><p><strong>Model Trends Using Regression</strong></p>
<p>Researchers in agronomy frequently perform dose- or rate-response studies. Regression models, rather than ANOVA, are generally the most appropriate way to analyse these data.</p></li>
</ol>
<div>
<ol start="2" type="1">
<li class="fragment"><p><strong>Best Model = Good Fit to Data + Useful to Researcher (+ Justified by Theory)</strong></p>
<p>Non-linear regression models can provide estimates of a parsimonious set of easily interpreted and biologically meaningful parameters, in a way that linear and polynomial regression sometimes cannot.</p></li>
<li class="fragment"><p><strong>Don’t Break Up Your Analysis, Build Out Your Model</strong></p>
<p>In general, it is better to analyse the data from all treatments/years/locations together, rather than separately. This slightly complicates model specification but (1) maximizes the precision of your estimates and, (2) greatly facilitates (and improves the statistical power of) subsequent testing.</p></li>
</ol>
</div>
</section>
<section id="preface-1" class="slide level2">
<h2>Preface:</h2>
<ol start="4" type="1">
<li><p><strong>Choose Versatile Software Tools</strong></p>
<p>It is better to become familiar with general-purpose non-linear modeling packages (e.g., <code>nlme</code>) than to rely on more user friendly but much less flexible, domain-specific R packages.</p></li>
</ol>
<div>
<ol start="5" type="1">
<li class="fragment"><p><strong>Breathe</strong></p>
<p>Fitting non-linear models requires optimization algorithms which are not guaranteed to find a solution, and the flexibility of non-linear modeling increases the scope for model misspecification/user error. Non-linear modeling thus requires more patience than when working with linear models, especially at the begining.</p></li>
</ol>
</div>
</section>
<section id="assumptions-scope" class="slide level2">
<h2>Assumptions &amp; Scope</h2>
<aside class="notes">
<ul>
<li><p>And finally, a word on assumptions underlying what we will consider today. Statistical models can thought of as decomposing a set of observations into their deterministic component and a stochastic component</p></li>
<li><p>From here on out, we are really only concerned with the deterministic piece, and will assume the simplest and most familiar version of the stochastic piece: independent, normally distributed errors with homogeneous variance. There are tools in R to relax these assumptions and generalize to other distributions but they’re beyond the scope of this tutorial.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<p><br> Observed Value = Deterministic Trend + Random Variation</p>
<p><span class="math display">\[
Y = f(x) + \epsilon
\]</span></p>
<p><span class="math display">\[
\epsilon \sim \mathrm{Normal}(0, \sigma^2)
\]</span></p>
<ul>
<li><p>Henceforth, we are only concerned with <span class="math inline">\(f(x)\)</span></p></li>
<li><p>Residuals assumed to be normally distributed, independent, with uniform variance</p></li>
<li><p>Tools do exist to relax these assumptions/extend this model, but are beyond our scope</p></li>
</ul>
</section>
<section>
<section id="linear-regression-models" class="title-slide slide level1 center">
<h1>Linear Regression Models</h1>
<aside class="notes">
<ul>
<li>Before considering non-linear models, we’re actually going to look at linear models and how to fit them using <code>gnls</code> or “generalized nonlinear least squares” function from the <code>nlme</code> package. Although this might seem odd, it will give us the chance to learn the syntax of the <code>gnls()</code> function, as well as introduce a few concepts that will be helpful later, in a simple and familiar context.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="simple-regression" class="slide level2 smaller">
<h2>Simple Regression</h2>
<aside class="notes">
<ul>
<li><p>Here we have the most commonly used formula for a simple regression model, which will be very familiar to everyone, with two parameters: <span class="math inline">\(\beta_0\)</span> known as the intercept and <span class="math inline">\(\beta_1\)</span> as the slope.</p></li>
<li><p>The intercept can be interpreted as the mean value of y when the value of x is zero, and the slope interpreted as the unit change in mean y per unit change in the x. We can see these relationships illustrated in the figure on the right.</p></li>
<li><p>In <code>gnls</code>, the model is specified almost identically to how it is written mathematically. Note that this is different from how the same model would be expressed in the the <code>lm</code> function, where only the data are given and the two parameters are implied.</p></li>
<li><p>To account for the fact that in <code>gnls</code> the model formula includes both parameters and data, there is another argument, <code>params</code>, where you define which terms in the model formula are parameters (note that all others must be the names of columns in your data.frame). In addition to identifying which terms are parameters, the params argument is also where you define <em>how</em> those parameters vary according to your treatment factors, such as the type of input or the cultivar you’re applying it to. In this example, we have no such covariates, so the right hand-side of this formula is simply a 1.</p></li>
<li><p>Finally, when fitting non-linear models we need to provide starting values for each parameter in the model. When the model is fit, R will use an optimization algorithm to search, beginning from these initial values, for a set of parameter values which maximizes the likelihood function for your particular model. In all of these initial examples, I’ll use starting values which match the figure shown on the right.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:60%;">
<p>Equation:</p>
<p><span class="math display">\[
f(x) = \beta_0 + \beta_1x
\]</span></p>
<p><span class="math inline">\(\beta_0\)</span>: intercept (i.e value of y when x = 0)</p>
<p><span class="math inline">\(\beta_1\)</span>: slope (i.e.&nbsp;change in y per unit change in x)</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" data-code-line-numbers="|2|4|5|8,9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># R Code: </span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">gnls</span>(<span class="at">model =</span> y <span class="sc">~</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>x, </span>
<span id="cb1-3"><a href="#cb1-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb1-4"><a href="#cb1-4"></a>     <span class="at">params =</span> b0 <span class="sc">+</span> b1 <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb1-5"><a href="#cb1-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">b0 =</span> <span class="dv">1</span>, <span class="at">b1 =</span> <span class="fl">0.2</span>))</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># Or, equivalently</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, </span>
<span id="cb1-9"><a href="#cb1-9"></a>   <span class="at">data =</span> ag_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-3-1.png" width="576"></p>
</div>
</div>
</div>
</div>
</section>
<section id="simple-regression-reparameterized" class="slide level2 smaller">
<h2>Simple Regression, Reparameterized</h2>
<aside class="notes">
<ul>
<li><p>Although what we’ve just seen is by far the most common way of formulating a simple regression model, it is not the only way. We can, if we want, transform the x variable and/or use algebraic identities to <em>reparameterize</em> our simple regression model, with the result that the function is completely unchanged but the interprepation or meaning of our parameters, and correspondingly their values, do change.</p></li>
<li><p>Here, I am first centering x variable around its mean, so that the intercept parameter, now denoted <span class="math inline">\(\alpha_0\)</span>, is interpreted as the value of y when x is at the mean of x. We also, by defining <span class="math inline">\(\alpha_1\)</span> as the inverse of <span class="math inline">\(\beta_1\)</span> now have a rate parameter which is understood as the change in x required to produce a unit change in y.</p></li>
<li><p>Fitting this parameterization requires corresponding change in the model formula and our starting values. Note that there are a few different reasons why we might want to employ a different parameterization of a model, but making it easier to choose good starting values is one of them.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:60%;">
<p>Equation:</p>
<p><span class="math display">\[
f(x) = \alpha_{0} + \frac{(x - \bar{x})}{\alpha_1}
\]</span></p>
<p><span class="math inline">\(\alpha_0\)</span>: intercept (i.e value of y when x = mean(x))</p>
<p><span class="math inline">\(\frac{1}{\beta_1} = \alpha_1\)</span>: rate (i.e.&nbsp;change in x which causes 1 unit change in y)</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" data-code-line-numbers="|2|4|5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># R Code: </span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">gnls</span>(<span class="at">model =</span> y <span class="sc">~</span> a0 <span class="sc">+</span> (x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">/</span>a1, </span>
<span id="cb2-3"><a href="#cb2-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb2-4"><a href="#cb2-4"></a>     <span class="at">params =</span> a0 <span class="sc">+</span> a1 <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2-5"><a href="#cb2-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">a0 =</span> <span class="dv">2</span>, <span class="at">a1 =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-5-1.png" width="576"></p>
</div>
</div>
</div>
</div>
</section>
<section id="no-intercept-model-or-the-one-parameter-line-function" class="slide level2 smaller">
<h2>No Intercept Model, or “The One Parameter Line Function”</h2>
<aside class="notes">
<ul>
<li><p>If the last model seemed a bit contrived (although I will note without going into detail that there can be good reasons to scale and center your covariates), consider another parameterization of the linear model which does occasionally come up in agronomy: the “no-intercept model”</p></li>
<li><p>This is employed when the researcher has a strong theoretical basis for believing that the average y value must be 0 when x is zero. This illustrates, firstly, how the intercept can be seen as an add-on to this more basic model, which allows the line to shift up or down, as well as how even in linear regression we’re often seeking a parameterization for our model which comports with our pre-existing, practical or theoretical knowledge of the system under study.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:60%;">
<p>Equation:</p>
<p><span class="math display">\[
f(x) = \beta_1x
\]</span></p>
<p><span class="math inline">\(\beta_1\)</span>: slope (i.e.&nbsp;change in y per unit change in x)</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" data-code-line-numbers="|2|4|8,9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># R Code: </span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">gnls</span>(<span class="at">model =</span> y <span class="sc">~</span> b1<span class="sc">*</span>x, </span>
<span id="cb3-3"><a href="#cb3-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb3-4"><a href="#cb3-4"></a>     <span class="at">params =</span> b1 <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb3-5"><a href="#cb3-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">b1 =</span> <span class="fl">0.2</span>))</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co"># Or, equivalently</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> x, <span class="co"># or y ~ x - 1</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>   <span class="at">data =</span> ag_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-7-1.png" width="576"></p>
</div>
</div>
</div>
</div>
</section>
<section id="ancova-common-slope" class="slide level2 smaller">
<h2>ANCOVA, Common Slope</h2>
<aside class="notes">
<ul>
<li><p>We now turn to an analysis of covariance type model (still a linear regression model) but one where the slope and/or intercept can vary according to some covariate.</p></li>
<li><p>Here we consider the case of a common slope among groups, but separate intercepts. In R, our model statement is exactly the same as for the simple regression model, since we still have just an intercept and slope, but our <code>params</code> statement changes. We now need a list with two different formulas - one for each parameter), and the formula for the <span class="math inline">\(\beta_0\)</span> parameter now has a covariate (we imagine there is a factor variable named <code>grp</code> in our data frame).</p></li>
<li><p>We can also see that we need two starting values for the intercept parameter, but notice that those values are <em>not</em> equal to the actual intercepts of the two groups: the values shown in the figure correspond to coefficient values of 1 and 1 not 1 and 2, why?</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:60%;">
<p>Equation:</p>
<p><span class="math display">\[
f(x) = \beta_{0i} + \beta_{1}x
\]</span></p>
<p><span class="math inline">\(\beta_0\)</span>: intercept for the <em>i</em>-th group</p>
<p><span class="math inline">\(\beta_{1i}\)</span>: slope for all groups</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" data-code-line-numbers="|4,5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># R Code: </span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">gnls</span>(<span class="at">model =</span> y <span class="sc">~</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>x, </span>
<span id="cb4-3"><a href="#cb4-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb4-4"><a href="#cb4-4"></a>     <span class="at">params =</span> <span class="fu">list</span>(b0 <span class="sc">~</span> grp, b1 <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb4-5"><a href="#cb4-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">b0 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">b1 =</span> <span class="fl">0.2</span>))</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># Or, equivalently</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="fu">lm</span>(<span class="at">model =</span> y <span class="sc">~</span> grp <span class="sc">+</span> x, <span class="at">data =</span> ag_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-9-1.png" width="576"></p>
</div>
</div>
</div>
</div>
</section>
<section id="interlude---design-matrices-contrast-specifications" class="slide level2 smaller">
<h2>Interlude - Design Matrices &amp; Contrast Specifications</h2>
<aside class="notes">
<ul>
<li><p>To understand what’s going on, we need to take a small detour to understand design matrices and contrast specifications.</p></li>
<li><p>Prior to fitting a model, a design matrix is constructed which encodes our data, and in the case of factor variables, it encodes them in terms of zero/one dummy variables.</p></li>
<li><p>You can see in this very simple example here that the first column, which corresponds to the beta 0 coefficient, gets applied to all observations, while the second column, associated with the treatement effect, only gets applied to the first two observations, as the value is zero elsewhere.</p></li>
<li><p>There are actually several different, somewhat arbitrary ways of constructing design matrices which depend on the type of contrast coding being employed. That choice doesn’t affect the overall model, but just like with a reparameterization, it changes both the interpretation and value of the coefficients.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p><strong>Design matrices (X)</strong> encode factor effects (<span class="math inline">\(\mathbf{\beta_1}\)</span>) in columns of dummy variables</p></li>
<li><p>There are several, somewhat arbitrary, ways to construct them depending on the <strong>contrast coding</strong> being used</p></li>
<li><p>The choice of contrast coding thus determines interpretation of coefficients and reasonable starting values (essentially, reparameterizations of the linear model)</p></li>
</ul>
</div><div class="column" style="width:50%;">
<p>Matrix algebra notation for a linear model:</p>
<p><span class="math inline">\(Y = \mathbf{X}\beta + \epsilon\)</span></p>
<p><br> For example, with 2 reps each of 2 treatments <br> <span class="math inline">\(\begin{bmatrix} Y_{1,1} \\ Y_{1, 2} \\ Y_{1, 1} \\ Y_{2, 2} \end{bmatrix}\)</span> <span class="math inline">\(=\)</span> <span class="math inline">\(\begin{bmatrix} 1 &amp; 1 \\ 1 &amp; 1 \\ 1 &amp; 0 \\ 1 &amp; 0 \\ \end{bmatrix}\)</span> <span class="math inline">\(\times\)</span> <span class="math inline">\(\begin{bmatrix} \ \beta_0 &amp; \beta_1 \end{bmatrix}'\)</span> <span class="math inline">\(+\)</span> <span class="math inline">\(\begin{bmatrix} \epsilon_{1,1} \\ \epsilon_{1,1} \\ \epsilon_{2, 1} \\ \epsilon_{2, 2} \end{bmatrix}\)</span></p>
</div>
</div>
</section>
<section id="interlude---design-matrices-contrast-specifications-1" class="slide level2 smaller">
<h2>Interlude - Design Matrices &amp; Contrast Specifications</h2>
<aside class="notes">
<ul>
<li><p>The default way that R constructs design matrices is using what it calls “treatment contrasts”, which sets the value of the first factor level as the intercept, and other effects are thus the difference in value between that factor and the first factor.</p></li>
<li><p>Thus if our first observation is from the “A” group, and our coefficients for the fitted model are 1 and 1, simply take the product of 1x1 + 1x0 and sum them to get the estimate of the <span class="math inline">\(\beta_0\)</span> parameter for the A group.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>“Treatment Contrasts”</strong> (R default)</p>
<ul>
<li><p>Intercept: value for the first factor level (a control, perhaps?)</p></li>
<li><p>Other coefficients: difference between the intercept and that factor level’s value</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Set contrast specification</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">'contr.treatment'</span>, <span class="st">'contr.poly'</span>))</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co"># print design matrix</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="fu">model.matrix</span>(<span class="sc">~</span> grp, <span class="at">data =</span> ag_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   
grp (Intercept) trtB
  A           1    0
  A           1    0
  A           1    0
  B           1    1
  B           1    1
  B           1    1</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>ANCOVA Example:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" data-code-line-numbers="5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># R Code: </span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">gnls</span>(<span class="at">model =</span> y <span class="sc">~</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>x, </span>
<span id="cb7-3"><a href="#cb7-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb7-4"><a href="#cb7-4"></a>     <span class="at">params =</span> <span class="fu">list</span>(b0 <span class="sc">~</span> grp, b1 <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb7-5"><a href="#cb7-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">b0 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">b1 =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-14-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="interlude---design-matrices-contrast-specifications-2" class="slide level2 smaller">
<h2>Interlude - Design Matrices &amp; Contrast Specifications</h2>
<aside class="notes">
<ul>
<li>An alternative, called “SAS contrasts” are basically the same but it is the last level of a factor which is treated as the reference or control.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>“SAS Contrasts”</strong></p>
<ul>
<li><p>Intercept: value for the <em>last</em> factor level (a control, perhaps?)</p></li>
<li><p>Other coefficients: difference between the intercept and that factor level’s value</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Set contrast specification</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">'contr.SAS'</span>, <span class="st">'contr.poly'</span>))</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># print design matrix</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="fu">model.matrix</span>(<span class="sc">~</span> grp, <span class="at">data =</span> ag_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   
grp (Intercept) trtA
  A           1    1
  A           1    1
  A           1    1
  B           1    0
  B           1    0
  B           1    0</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>ANCOVA Example:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" data-code-line-numbers="5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># R Code: </span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">gnls</span>(<span class="at">model =</span> y <span class="sc">~</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>x, </span>
<span id="cb10-3"><a href="#cb10-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb10-4"><a href="#cb10-4"></a>     <span class="at">params =</span> <span class="fu">list</span>(b0 <span class="sc">~</span> grp, b1 <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb10-5"><a href="#cb10-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">b0 =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="at">b1 =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-19-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="interlude---design-matrices-contrast-specifications-3" class="slide level2 smaller">
<h2>Interlude - Design Matrices &amp; Contrast Specifications</h2>
<aside class="notes">
<ul>
<li>There are also “sum-to-zero” contrasts, where the last factor level is set equal to -1 times the sum of the other coefficients, or the difference in that factor level and the overall average level among all factor levels.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>“Sum-to-Zero Contrasts”</strong></p>
<ul>
<li><p>Intercept: average value across all factor levels</p></li>
<li><p>Other coefficients: difference between the intercept and that factor level’s value</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Set contrast specification</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">'contr.sum'</span>, <span class="st">'contr.poly'</span>))</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co"># print design matrix</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="fu">model.matrix</span>(<span class="sc">~</span> grp, <span class="at">data =</span> ag_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   
grp (Intercept) trt1
  A           1    1
  A           1    1
  A           1    1
  B           1   -1
  B           1   -1
  B           1   -1</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>ANCOVA Example:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" data-code-line-numbers="5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># R Code: </span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="fu">gnls</span>(<span class="at">model =</span> y <span class="sc">~</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>x, </span>
<span id="cb13-3"><a href="#cb13-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb13-4"><a href="#cb13-4"></a>     <span class="at">params =</span> <span class="fu">list</span>(b0 <span class="sc">~</span> grp, b1 <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb13-5"><a href="#cb13-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">b0 =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="sc">-</span><span class="fl">0.5</span>), <span class="at">b1 =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-24-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="interlude---design-matrices-contrast-specifications-4" class="slide level2 smaller">
<h2>Interlude - Design Matrices &amp; Contrast Specifications</h2>
<aside class="notes">
<ul>
<li>Each of these contrast specifications have different instances where they are more or less useful, but in terms of setting starting values, I find it extremely useful to use the “no intercept” trick, which by removing the intercept from the design matrix entirely, allows each column to correspond to one of the groups. This works regardless of which contrast specification is used.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>“No Intercept”</strong></p>
<ul>
<li>Each coefficient is the value for that group</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># This works for any contrast specification, but becomes slightly</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># complicated in the presence of interactions</span></span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co"># print design matrix</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="fu">model.matrix</span>(<span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> grp, <span class="at">data =</span> ag_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   
grp trtA trtB
  A    1    0
  A    1    0
  A    1    0
  B    0    1
  B    0    1
  B    0    1</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>ANCOVA Example:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" data-code-line-numbers="4,5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># R Code: </span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">gnls</span>(<span class="at">model =</span> y <span class="sc">~</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>x, </span>
<span id="cb16-3"><a href="#cb16-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb16-4"><a href="#cb16-4"></a>     <span class="at">params =</span> <span class="fu">list</span>(b0 <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> grp, b1 <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb16-5"><a href="#cb16-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">b0 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">b1 =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-29-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="ancova-separate-intercepts-slopes" class="slide level2 smaller">
<h2>ANCOVA, Separate Intercepts &amp; Slopes</h2>
<aside class="notes">
<ul>
<li>And generalizing all of this to an ancova type model with seperate slopes and intercepts is straightforward, we simply revert back to a common params formula, as both the intercept and slope vary by group, and provide two starting values for each of the two parameters.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:60%;">
<p>Equation:</p>
<p><span class="math display">\[
f(x) = \beta_{0i} + \beta_{1i}x
\]</span></p>
<p><span class="math inline">\(\beta_0\)</span>: intercept for the <em>i</em>-th group</p>
<p><span class="math inline">\(\beta_{1i}\)</span>: slope for the <em>i</em>-th group</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" data-code-line-numbers="|2|4,5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># R Code: </span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">gnls</span>(<span class="at">model =</span> y <span class="sc">~</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>x, </span>
<span id="cb17-3"><a href="#cb17-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb17-4"><a href="#cb17-4"></a>     <span class="at">params =</span> b0 <span class="sc">+</span> b1 <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> group,</span>
<span id="cb17-5"><a href="#cb17-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">b0 =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">1.0</span>), <span class="at">b1 =</span> <span class="fu">c</span>(<span class="fl">0.125</span>, <span class="fl">0.2</span>)))</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co"># Or, equivalently</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="fu">lm</span>(<span class="at">model =</span> y <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> grp <span class="sc">+</span> grp<span class="sc">:</span>x, <span class="at">data =</span> ag_exp) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-31-1.png" width="576"></p>
</div>
</div>
</div>
</div>
</section>
<section id="polynomial-regression" class="slide level2 smaller">
<h2>Polynomial Regression</h2>
<aside class="notes">
<p>-Not all trends exhibit curvature, and a commonly employed way to account for this is polynomial regression, such as the following quadratic regression model.</p>
<ul>
<li>This model is easy to fit using <code>lm</code> or other linear modeling functions, but terms are not all easy to interpret. The intercept has the same meaning as in the other regression models, but the “slope” is now only actually the slope when x is exactly 0, and the <span class="math inline">\(\beta_2\)</span> perameter is the rate of change in the rate of change, or decelleration.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:60%;">
<p>Equation:</p>
<p><span class="math display">\[
f(x) = \beta_{0} + \beta_{1}x + \beta_2x^2
\]</span></p>
<p><span class="math inline">\(\beta_0\)</span>: intercept</p>
<p><span class="math inline">\(\beta_{1}\)</span>: slope (when x is 0?)</p>
<p><span class="math inline">\(\beta_2\)</span>: “deceleration” (?)</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" data-code-line-numbers="|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># R Code: </span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">gnls</span>(<span class="at">model =</span> y <span class="sc">~</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>x <span class="sc">+</span> b2<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb18-3"><a href="#cb18-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb18-4"><a href="#cb18-4"></a>     <span class="at">params =</span> b0 <span class="sc">+</span> b1 <span class="sc">+</span> b2<span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb18-5"><a href="#cb18-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">b0 =</span> <span class="fl">1.0</span>, <span class="at">b1 =</span> <span class="fl">0.2</span>, <span class="at">b2 =</span> <span class="sc">-</span><span class="fl">0.015</span>))</span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co"># Or, equivalently</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="fu">lm</span>(<span class="at">model =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> ag_exp) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-33-1.png" width="576"></p>
</div>
</div>
</div>
</div>
</section>
<section id="polynomial-regression-reparameterized" class="slide level2 smaller">
<h2>Polynomial Regression, Reparameterized</h2>
<aside class="notes">
<ul>
<li><p>But, we actually have the option to instead reparameterize this, expressing it using the formula commonly used parabolas (which this curve is) in geometry, with the advantage that our parameters are now much more easily interpreted.</p></li>
<li><p>This parameterization cannot be fit using <code>lm</code> however, because it is in fact, non-linear</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:60%;">
<p>Equation:</p>
<p><span class="math display">\[
f(x) = \alpha_1 + \kappa(x - \alpha_0)^2
\]</span></p>
<p><span class="math inline">\(\alpha_0\)</span>: optimum x value (i.e.&nbsp;x value which maximizes y)</p>
<p><span class="math inline">\(\alpha_{1}\)</span>: maximum y value</p>
<p><span class="math inline">\(\kappa\)</span>: related to “steepness” of the curve</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" data-code-line-numbers="|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># R Code: </span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="fu">gnls</span>(<span class="at">model =</span> y <span class="sc">~</span> a1 <span class="sc">+</span> k1<span class="sc">*</span>(x <span class="sc">-</span> a0)<span class="sc">^</span><span class="dv">2</span>, </span>
<span id="cb19-3"><a href="#cb19-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb19-4"><a href="#cb19-4"></a>     <span class="at">params =</span> a0 <span class="sc">+</span> a1 <span class="sc">+</span> k <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb19-5"><a href="#cb19-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">a0 =</span> <span class="dv">5</span>, <span class="at">a1 =</span> <span class="fl">1.5</span>, <span class="at">k =</span> <span class="sc">-</span><span class="fl">0.02</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-35-1.png" width="576"></p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="non-linear-regression-models" class="title-slide slide level1 center">
<h1>Non-Linear Regression Models</h1>
<aside class="notes">
<ul>
<li><p>I’ve given the technical definition of a non-linear model there but what matters is that it actually has nothing to do with the curviness of the function, and sometimes even the same function can be linear or nonlinear depending on the paramterization</p></li>
<li><p>Instead, you can think of nonlinear models as those which…</p></li>
<li><p>In the following slides, we’ll only consider a couple of them but there are many, many models which have been developed for different systems or biological phenomena, often with numerous different parameterizations, and at the end I’ll provide references which provide much more detailed descriptions of many of them.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<p><br> <strong>Technical Definition</strong>: Functions with a first derivative with respect to at least one parameter which is a function of another parameter (takeaway is that its not actually about “curviness”, and some functions can be linear or nonlinear depending on the parameterization).</p>
<p><br> <strong>Plain(-ish) Language Summary</strong>: Functions which exhibit some combination of <em>limiting behavior</em>, such as asymptotically approaching an upper or lower limit, <em>critical points</em>, such as a maximum or minimum, and <em>inflection points</em>, where a trend switches from accelerating to decelerating.</p>
</section>
<section id="michaelis-menton-function" class="slide level2 smaller">
<h2>Michaelis-Menton Function</h2>
<aside class="notes">
<ul>
<li><p>The first that we’ll consider is the Michaelis-Menton function equation, otherwise known as the Monad function, Shinozaki-Kira function, and possibly others.</p></li>
<li><p>The alpha parameter…</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:60%;">
<p>Equation:</p>
<p><span class="math display">\[
f(x) = \frac{\alpha x}{\beta + x}
\]</span></p>
<p><span class="math inline">\(\alpha\)</span>: asymptote (y value as <span class="math inline">\(x \rightarrow \infty\)</span>)</p>
<p><span class="math inline">\(\beta\)</span>: half-maximum (x value where y = <span class="math inline">\(\frac{\alpha}{2}\)</span>)</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" data-code-line-numbers="|"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># R Code: </span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="fu">gnls</span>(<span class="at">model =</span> y <span class="sc">~</span> a<span class="sc">*</span>x<span class="sc">/</span>(b<span class="sc">+</span>x), </span>
<span id="cb20-3"><a href="#cb20-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb20-4"><a href="#cb20-4"></a>     <span class="at">params =</span> a <span class="sc">+</span> d <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb20-5"><a href="#cb20-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">3</span>, <span class="at">b =</span> <span class="fl">1.7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-37-1.png" width="576"></p>
</div>
</div>
</div>
</div>
</section>
<section id="michaelis-menton-function-1" class="slide level2 smaller">
<h2>Michaelis-Menton Function</h2>
<aside class="notes">
<ul>
<li><p>Although our fitted model gives us the maximum possible response, we’re often interested in a target value which achieves some percentage of that maximum, which can be calculated using this formula here.</p></li>
<li><p>Alternatively, if we have price information we can calculate, by plugging in our model estimates into this formula, the net return, which using this formula allows us to calculate an economic optimum rate.</p></li>
<li><p>I’m glossing over where these formula come from because that’s less imporant for you to know than that you have an appreciation for the kinds of values that can be derived from this and other, similar, models. But with that said, most of this can be derived just using very basic algebra.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="columns">
<div class="column" style="width:60%;">
<p>Target rate, <span class="math inline">\(T_p\)</span>, will be x value that achieves some percent, <em>P</em>, of the asymptote:</p>
<p><span class="math display">\[
T_p = \frac{\beta P}{1-P}
\]</span></p>
<p>or, if prices, <span class="math inline">\(C_x\)</span> and <span class="math inline">\(C_y\)</span>, are known for x and y, respectively, then you can calculate net returns (<span class="math inline">\(I_{net}\)</span>):</p>
<p><span class="math display">\[
I_{net} = \frac{C_y\alpha x}{\beta + x}  - xC_x
\]</span> <span class="math inline">\(\alpha\)</span>: asymptote (y value as <span class="math inline">\(x \rightarrow \infty\)</span>)</p>
<p><span class="math inline">\(\beta\)</span>: half-maximum (x value where y = <span class="math inline">\(\frac{\alpha}{2}\)</span>)</p>
</div><div class="column" style="width:40%;">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-38-1.png" width="576"></p>
</div>
</div>
</div>
</div>
</section>
<section id="example-1-onion-yield-response-to-seeding-rate" class="slide level2 smaller">
<h2>Example 1: Onion Yield Response to Seeding Rate</h2>
<p>First, run the following (after installing the required packages, as necessary) to set up our R environment:</p>
<div class="cell" data-messages="false">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># Load packages</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="fu">library</span>(agridat)</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="fu">library</span>(nlme)</span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="fu">library</span>(ggResidpanel)</span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="fu">library</span>(car)</span>
<span id="cb21-9"><a href="#cb21-9"></a></span>
<span id="cb21-10"><a href="#cb21-10"></a><span class="co"># set ggplot aesthetics</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>my_pal <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'steelblue'</span>, <span class="st">'sienna'</span>, <span class="st">'olivedrab'</span>, <span class="st">'goldenrod'</span>)</span>
<span id="cb21-12"><a href="#cb21-12"></a>my_theme <span class="ot">=</span> <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), </span>
<span id="cb21-14"><a href="#cb21-14"></a>        <span class="at">legend.position =</span> <span class="st">'bottom'</span>)</span>
<span id="cb21-15"><a href="#cb21-15"></a></span>
<span id="cb21-16"><a href="#cb21-16"></a><span class="fu">options</span>(<span class="at">ggplot2.discrete.colour =</span> my_pal, </span>
<span id="cb21-17"><a href="#cb21-17"></a>        <span class="at">ggplot2.discrete.fill =</span> my_pal)</span>
<span id="cb21-18"><a href="#cb21-18"></a><span class="fu">theme_set</span>(my_theme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-1-onion-yield-response-to-seeding-rate-1" class="slide level2 smaller">
<h2>Example 1: Onion Yield Response to Seeding Rate</h2>
<p>This data is adapted from <span class="citation" data-cites="schabenbergerContemporaryStatisticalModels2001">Schabenberger and Pierce (<a href="#/references" role="doc-biblioref" onclick="">2001</a>)</span> and originally reported in <span class="citation" data-cites="meadPlantDensityCrop1970">Mead (<a href="#/references" role="doc-biblioref" onclick="">1970</a>)</span>. It contains the yield (<span class="math inline">\(\mathrm{kg/m^2}\)</span>) of three onion (<em>Allium cipa</em> L.) cultivars when planted at various densities (<span class="math inline">\(\mathrm{plants/m^2}\)</span>). <span class="citation" data-cites="schabenbergerContemporaryStatisticalModels2001">Schabenberger and Pierce (<a href="#/references" role="doc-biblioref" onclick="">2001</a>)</span> fit an alternative parameterization of the Michaelis-Menton function and referred to it by a different name.</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Load and prep data</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>onion <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-3"><a href="#cb22-3"></a>   <span class="at">Cultivar =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">each =</span> <span class="dv">10</span>)), </span>
<span id="cb22-4"><a href="#cb22-4"></a>   <span class="at">Density =</span> <span class="fu">c</span>(<span class="fl">33.045</span>, <span class="fl">35.629</span>, <span class="fl">64.261</span>, <span class="fl">75.24</span>, <span class="fl">93.323</span>,</span>
<span id="cb22-5"><a href="#cb22-5"></a>               <span class="fl">144.129</span>, <span class="fl">192.243</span>, <span class="fl">232.178</span>, <span class="fl">309.678</span>, <span class="fl">334.542</span>,</span>
<span id="cb22-6"><a href="#cb22-6"></a>               <span class="fl">23.035</span>, <span class="fl">28.524</span>, <span class="fl">40.903</span>, <span class="fl">56.403</span>, <span class="fl">84.281</span>,</span>
<span id="cb22-7"><a href="#cb22-7"></a>               <span class="fl">93.861</span>, <span class="fl">108.823</span>, <span class="fl">173.084</span>, <span class="fl">228.41</span>, <span class="fl">276.74</span>, </span>
<span id="cb22-8"><a href="#cb22-8"></a>               <span class="fl">26.694</span>, <span class="fl">37.997</span>, <span class="fl">47.899</span>, <span class="fl">67.059</span>, <span class="fl">88.587</span>,</span>
<span id="cb22-9"><a href="#cb22-9"></a>               <span class="fl">103.226</span>, <span class="fl">181.587</span>, <span class="fl">201.177</span>, <span class="fl">277.063</span>, <span class="fl">326.469</span>), </span>
<span id="cb22-10"><a href="#cb22-10"></a>   <span class="at">Yield =</span> <span class="fu">c</span>(<span class="fl">3.49</span>, <span class="fl">3.185</span>, <span class="fl">4.562</span>, <span class="fl">4.537</span>, <span class="fl">4.442</span>, </span>
<span id="cb22-11"><a href="#cb22-11"></a>             <span class="fl">5.434</span>, <span class="fl">5.825</span>, <span class="fl">5.619</span>, <span class="fl">6.441</span>, <span class="fl">6.189</span>,</span>
<span id="cb22-12"><a href="#cb22-12"></a>             <span class="fl">3.031</span>, <span class="fl">3.112</span>, <span class="fl">3.833</span>, <span class="fl">4.072</span>, <span class="fl">4.475</span>, </span>
<span id="cb22-13"><a href="#cb22-13"></a>             <span class="fl">4.665</span>, <span class="fl">4.114</span>, <span class="fl">5.764</span>, <span class="fl">5.596</span>, <span class="fl">5.064</span>,</span>
<span id="cb22-14"><a href="#cb22-14"></a>             <span class="fl">3.118</span>, <span class="fl">3.48</span>, <span class="fl">3.482</span>, <span class="fl">3.541</span>, <span class="fl">4.323</span>,</span>
<span id="cb22-15"><a href="#cb22-15"></a>             <span class="fl">4.036</span>, <span class="fl">5.502</span>, <span class="fl">4.868</span>, <span class="fl">5.541</span>, <span class="fl">5.321</span>))</span>
<span id="cb22-16"><a href="#cb22-16"></a></span>
<span id="cb22-17"><a href="#cb22-17"></a><span class="fu">str</span>(onion, <span class="at">width =</span> <span class="dv">60</span>, <span class="at">strict.width =</span> <span class="st">'cut'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   30 obs. of  3 variables:
 $ Cultivar: Factor w/ 3 levels "A","B","C": 1 1 1 1 1 1 1..
 $ Density : num  33 35.6 64.3 75.2 93.3 ...
 $ Yield   : num  3.49 3.18 4.56 4.54 4.44 ...</code></pre>
</div>
</div>
</div>
</section>
<section id="exploratory-data-analysis-ex.-1" class="slide level2 smaller">
<h2>Exploratory Data Analysis (Ex. 1)</h2>
<div class="cell" data-layout-align="center" data-fig.asp="0.33">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">ggplot</span>(onion, <span class="fu">aes</span>(<span class="at">x =</span> Density, <span class="at">y =</span> Yield, <span class="at">color =</span> Cultivar))<span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="co"># Plot the data itself</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Cultivar)<span class="sc">+</span> </span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-layout-align="center" data-fig.asp="0.33">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-41-1.png" width="1440"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exploratory-data-analysis-ex.-1-1" class="slide level2 smaller">
<h2>Exploratory Data Analysis (Ex. 1)</h2>
<div class="cell" data-layout-align="center" data-fig.asp="0.33">
<div class="sourceCode cell-code" id="cb25" data-code-line-numbers="|5-6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">ggplot</span>(onion, <span class="fu">aes</span>(<span class="at">x =</span> Density, <span class="at">y =</span> Yield, <span class="at">color =</span> Cultivar))<span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>      <span class="co"># Plot the data itself </span></span>
<span id="cb25-3"><a href="#cb25-3"></a>      <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(Cultivar))<span class="sc">+</span> </span>
<span id="cb25-4"><a href="#cb25-4"></a>      <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>      <span class="co"># Plot linear trend</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> F, <span class="at">size =</span> .<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-layout-align="center" data-fig.asp="0.33">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-42-1.png" width="1440"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exploratory-data-analysis-ex.-1-2" class="slide level2 smaller">
<h2>Exploratory Data Analysis (Ex. 1)</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb26" data-code-line-numbers="|1-4|6-8|14-18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># Michaelis-Menton function</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>micmen <span class="ot">=</span> <span class="cf">function</span>(x, ymax, xhalf){</span>
<span id="cb26-3"><a href="#cb26-3"></a>  ymax<span class="sc">*</span>x<span class="sc">/</span>(xhalf <span class="sc">+</span> x)</span>
<span id="cb26-4"><a href="#cb26-4"></a>}</span>
<span id="cb26-5"><a href="#cb26-5"></a></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co"># Considering just cultivar A</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>onion <span class="sc">|&gt;</span> </span>
<span id="cb26-8"><a href="#cb26-8"></a>  <span class="fu">filter</span>(Cultivar <span class="sc">==</span> <span class="st">'A'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-9"><a href="#cb26-9"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Density, <span class="at">y =</span> Yield, <span class="at">color =</span> Cultivar))<span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>      <span class="co"># Plot the data itself </span></span>
<span id="cb26-11"><a href="#cb26-11"></a>      <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12"></a>      <span class="co"># Plot linear trend</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>      <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se =</span> F, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14"></a>      <span class="co"># Plot Mitscherlich trend, using this </span></span>
<span id="cb26-15"><a href="#cb26-15"></a>      <span class="co"># to identify reasonable starting values</span></span>
<span id="cb26-16"><a href="#cb26-16"></a>      <span class="fu">geom_function</span>(<span class="at">fun =</span> micmen, </span>
<span id="cb26-17"><a href="#cb26-17"></a>                    <span class="at">args =</span> <span class="fu">list</span>(<span class="at">ymax =</span> <span class="dv">7</span>,</span>
<span id="cb26-18"><a href="#cb26-18"></a>                                <span class="at">xhalf =</span> <span class="dv">40</span>), </span>
<span id="cb26-19"><a href="#cb26-19"></a>                    <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-44-1.png" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="model-development-evaluation-ex.-1" class="slide level2 smaller">
<h2>Model Development &amp; Evaluation (Ex. 1)</h2>
<p>First, fit the linear model (this could be done using <code>lm</code>).</p>
<div class="cell" data-layout-align="center" data-fig.asp="1">
<div class="sourceCode cell-code" id="cb27" data-code-line-numbers="|2|4|5-6|7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># Fit the linear (ANCOVA) regression model</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>onion_mod_lin <span class="ot">=</span> <span class="fu">gnls</span>(<span class="at">model =</span> Yield <span class="sc">~</span> yinit <span class="sc">+</span> slope<span class="sc">*</span>Density,</span>
<span id="cb27-3"><a href="#cb27-3"></a>                    <span class="at">data =</span> onion, </span>
<span id="cb27-4"><a href="#cb27-4"></a>                    <span class="at">params =</span> yinit <span class="sc">+</span> slope <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Cultivar, </span>
<span id="cb27-5"><a href="#cb27-5"></a>                    <span class="at">start =</span> <span class="fu">c</span>(<span class="at">yinit =</span> <span class="fu">c</span>(<span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">3.5</span>), </span>
<span id="cb27-6"><a href="#cb27-6"></a>                              <span class="at">slope =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>)))</span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="fu">print</span>(onion_mod_lin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized nonlinear least squares fit
  Model: Yield ~ yinit + slope * Density 
  Data: onion 
  Log-likelihood: -16.46228

Coefficients:
yinit.CultivarA yinit.CultivarB yinit.CultivarC slope.CultivarA slope.CultivarB 
    3.579669886     3.375371187     3.229866885     0.009197382     0.008951270 
slope.CultivarC 
    0.008037759 

Degrees of freedom: 30 total; 24 residual
Residual standard error: 0.4683104 </code></pre>
</div>
</div>
</section>
<section id="model-development-evaluation-ex.-1-1" class="slide level2 smaller">
<h2>Model Development &amp; Evaluation (Ex. 1)</h2>
<p>Next, fit the Mitscherlich model:</p>
<div class="cell" data-layout-align="center" data-fig.asp="1">
<div class="sourceCode cell-code" id="cb29" data-code-line-numbers="|2|4|5-7|8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># Fit the Michaelis-Menton model</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>onion_mod_mm <span class="ot">=</span> <span class="fu">gnls</span>(<span class="at">model =</span> Yield <span class="sc">~</span> ymax<span class="sc">*</span>Density<span class="sc">/</span>(xhalf <span class="sc">+</span> Density), </span>
<span id="cb29-3"><a href="#cb29-3"></a>                     <span class="at">data =</span> onion, </span>
<span id="cb29-4"><a href="#cb29-4"></a>                     <span class="at">params =</span> ymax <span class="sc">+</span> xhalf <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Cultivar, </span>
<span id="cb29-5"><a href="#cb29-5"></a>                     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">curv =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">40</span>, <span class="dv">40</span>),</span>
<span id="cb29-6"><a href="#cb29-6"></a>                               <span class="at">ymax =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">7</span>)))</span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="fu">print</span>(onion_mod_mm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized nonlinear least squares fit
  Model: Yield ~ ymax * Density/(xhalf + Density) 
  Data: onion 
  Log-likelihood: -6.436848

Coefficients:
 ymax.CultivarA  ymax.CultivarB  ymax.CultivarC xhalf.CultivarA xhalf.CultivarB 
       6.863395        5.849601        5.847467       37.721908       23.875150 
xhalf.CultivarC 
      30.484627 

Degrees of freedom: 30 total; 24 residual
Residual standard error: 0.3352747 </code></pre>
</div>
</div>
</section>
<section id="model-development-evaluation-ex.-1-2" class="slide level2 smaller">
<h2>Model Development &amp; Evaluation (Ex. 1)</h2>
<p><span class="math inline">\(\Delta\)</span>AIC strongly favors of the non-linear model. The diagnostic plots of the residuals indicate possible minor violations of the assumptions of normality and homoscedasticity, which in other circumstances I would probe into further, but that is beyond the scope of this workshop.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># compare the two models</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="fu">AIC</span>(onion_mod_lin, onion_mod_mm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              df      AIC
onion_mod_lin  7 46.92457
onion_mod_mm   7 26.87370</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>onion_mod_res <span class="ot">=</span> <span class="fu">resid</span>(onion_mod_mm, <span class="at">type =</span> <span class="st">'normalized'</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>onion_mod_pred <span class="ot">=</span> <span class="fu">fitted</span>(onion_mod_mm)</span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="fu">resid_auxpanel</span>(onion_mod_res, onion_mod_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center" data-fig.asp="1">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-49-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="estimation-inference-and-graphing-ex.-1" class="slide level2 smaller">
<h2>Estimation, Inference and Graphing (Ex. 1)</h2>
<p>All the tools from the <code>emmeans</code> package will work with models fit with <code>gnls</code>, you simply need to specify the parameter of interest via the argument <code>param</code>:</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># Perform F-Test</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="fu">joint_tests</span>(onion_mod_mm, <span class="at">param =</span> <span class="st">'ymax'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output cell-output-stdout">
<pre><code> model term df1 df2 F.ratio p.value
 Cultivar     2  23   4.316  0.0256</code></pre>
</div>
</div>
</div>
<p><br></p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># Calculate estimated marginal means</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>(<span class="at">onion_emm_ymax =</span> <span class="fu">emmeans</span>(onion_mod_mm, <span class="sc">~</span> Cultivar,</span>
<span id="cb36-3"><a href="#cb36-3"></a>                         <span class="at">param =</span> <span class="st">'ymax'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output cell-output-stdout">
<pre><code> Cultivar emmean    SE df lower.CL upper.CL
 A          6.86 0.287 23     6.27     7.46
 B          5.85 0.272 23     5.29     6.41
 C          5.85 0.274 23     5.28     6.41

Confidence level used: 0.95 </code></pre>
</div>
</div>
</div>
<p><br></p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># Perform contrasts </span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="fu">contrast</span>(onion_emm_ymax, <span class="st">'pairwise'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output cell-output-stdout">
<pre><code> contrast estimate    SE df t.ratio p.value
 A - B     1.01379 0.395 23   2.567  0.0438
 A - C     1.01593 0.396 23   2.563  0.0442
 B - C     0.00213 0.386 23   0.006  1.0000

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
</div>
</section>
<section id="estimation-inference-and-graphing-ex.-1-1" class="slide level2 smaller">
<h2>Estimation, Inference and Graphing (Ex. 1)</h2>
<p>For derived quantities such as <span class="math inline">\(T_{90\%}\)</span>, we can use the delta method to generate estimates, standard errors, and confidence intervals:</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># names of coefficients used in formula for </span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="co"># derived quantities must match output from coef()</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="fu">print</span>(<span class="fu">names</span>(<span class="fu">coef</span>(onion_mod_mm)), <span class="at">width =</span> <span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ymax.CultivarA"  "ymax.CultivarB" 
[3] "ymax.CultivarC"  "xhalf.CultivarA"
[5] "xhalf.CultivarB" "xhalf.CultivarC"</code></pre>
</div>
</div>
</div>
<p><br></p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb42" data-code-line-numbers="|3|4|5|14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># Calculate 90% target rate for each cultivar, and </span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="co"># output the results</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>t90a <span class="ot">=</span> <span class="fu">deltaMethod</span>(<span class="at">object =</span> onion_mod_mm, </span>
<span id="cb42-4"><a href="#cb42-4"></a>                   <span class="at">g. =</span> <span class="st">'xhalf.CultivarA*0.9/(1 - 0.9)'</span>, </span>
<span id="cb42-5"><a href="#cb42-5"></a>                   <span class="at">func =</span> <span class="st">'T90% for Cultivar A:'</span>)</span>
<span id="cb42-6"><a href="#cb42-6"></a></span>
<span id="cb42-7"><a href="#cb42-7"></a>t90b <span class="ot">=</span> <span class="fu">deltaMethod</span>(<span class="at">object =</span> onion_mod_mm, </span>
<span id="cb42-8"><a href="#cb42-8"></a>                   <span class="at">g. =</span> <span class="st">'xhalf.CultivarB*0.9/(1 - 0.9)'</span>, </span>
<span id="cb42-9"><a href="#cb42-9"></a>                   <span class="at">func =</span> <span class="st">'T90% for Cultivar B:'</span>)</span>
<span id="cb42-10"><a href="#cb42-10"></a></span>
<span id="cb42-11"><a href="#cb42-11"></a>t90c <span class="ot">=</span> <span class="fu">deltaMethod</span>(<span class="at">object =</span> onion_mod_mm, </span>
<span id="cb42-12"><a href="#cb42-12"></a>                   <span class="at">g. =</span> <span class="st">'xhalf.CultivarC*0.9/(1 - 0.9)'</span>, </span>
<span id="cb42-13"><a href="#cb42-13"></a>                   <span class="at">func =</span> <span class="st">'T90% for Cultivar C:'</span>)</span>
<span id="cb42-14"><a href="#cb42-14"></a><span class="fu">rbind</span>(t90a, t90b, t90c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output cell-output-stdout">
<pre><code>                     Estimate      SE   2.5 % 97.5 %
T90% for Cultivar A:  339.497  56.198 229.352 449.64
T90% for Cultivar B:  214.876  42.219 132.129 297.62
T90% for Cultivar C:  274.362  52.767 170.940 377.78</code></pre>
</div>
</div>
</div>
</section>
<section id="estimation-inference-and-graphing-ex.-1-2" class="slide level2 smaller">
<h2>Estimation, Inference and Graphing (Ex. 1)</h2>
<p>The <code>marginaleffects</code> package has additional tools for generating estimates and confidence band for the fitted trendline:</p>
<div class="cell" data-layout-align="center" data-fig.asp="0.33">
<div class="sourceCode cell-code" id="cb44" data-code-line-numbers="|1-4|6-10|12-18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># Generate a new data set containing all combinations of </span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="co"># cultivar levels and a fine grid of density values</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>toplot <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="at">Cultivar =</span> <span class="fu">factor</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),</span>
<span id="cb44-4"><a href="#cb44-4"></a>                     <span class="at">Density =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">33</span><span class="sc">*</span><span class="dv">10</span>) </span>
<span id="cb44-5"><a href="#cb44-5"></a></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="co"># Generate predictions for these new cultivar and density</span></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="co"># combinations</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>onion_preds <span class="ot">=</span> <span class="fu">avg_predictions</span>(<span class="at">model =</span> onion_mod_mm, </span>
<span id="cb44-9"><a href="#cb44-9"></a>                             <span class="at">newdata =</span> toplot, </span>
<span id="cb44-10"><a href="#cb44-10"></a>                             <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'Cultivar'</span>, <span class="st">'Density'</span>))</span>
<span id="cb44-11"><a href="#cb44-11"></a></span>
<span id="cb44-12"><a href="#cb44-12"></a><span class="co"># Plot the results, along with the original data</span></span>
<span id="cb44-13"><a href="#cb44-13"></a><span class="fu">ggplot</span>(onion_preds, <span class="fu">aes</span>(<span class="at">x =</span> Density, <span class="at">color =</span> Cultivar, <span class="at">fill =</span> Cultivar)) <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(Cultivar))<span class="sc">+</span></span>
<span id="cb44-15"><a href="#cb44-15"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high),</span>
<span id="cb44-16"><a href="#cb44-16"></a>              <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb44-17"><a href="#cb44-17"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate))<span class="sc">+</span></span>
<span id="cb44-18"><a href="#cb44-18"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Yield), <span class="at">data =</span> onion, <span class="at">size =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="estimation-inference-and-graphing-ex.-1-2-output" class="slide level2 smaller output-location-slide"><h2>Estimation, Inference and Graphing (Ex. 1)</h2><div class="cell output-location-slide" data-layout-align="center" data-fig.asp="0.33">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-55-1.png" width="1440"></p>
</figure>
</div>
</div>
</div></section><section id="log-logistic-function" class="slide level2 smaller">
<h2>Log-Logistic Function</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>Equation:</p>
<p><span class="math display">\[
f(x) = \alpha_0 + \frac{\alpha_1 - \alpha_0}{1+e^{-\beta(\mathrm{ln}(x)-\mathrm{ln}(EC_{50}))}}
\]</span></p>
<p><span class="math inline">\(\alpha_0\)</span> is the intercept</p>
<p><span class="math inline">\(\alpha_1\)</span> is the lower limit</p>
<p><span class="math inline">\(\beta\)</span> is the “slope”</p>
<p><span class="math inline">\(EC_{50}\)</span> is half-maximal effective concentration</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># R Code:</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="fu">gnls</span>(y <span class="sc">~</span> a0 <span class="sc">+</span> (a1 <span class="sc">-</span> a0)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>b<span class="sc">*</span>(<span class="fu">log</span>(x) <span class="sc">-</span> <span class="fu">log</span>(EC50)))),  </span>
<span id="cb45-3"><a href="#cb45-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb45-4"><a href="#cb45-4"></a>     <span class="at">params =</span> a0 <span class="sc">+</span> a1 <span class="sc">+</span> b <span class="sc">+</span> IC50 <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb45-5"><a href="#cb45-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">a0 =</span> <span class="dv">1</span>, <span class="at">a1 =</span> <span class="fl">0.2</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">EC50 =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-57-1.png" width="576"></p>
</div>
</div>
</div>
</div>
</section>
<section id="exponential-decay-function" class="slide level2 smaller">
<h2>Exponential Decay Function</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>Equation:</p>
<p><span class="math display">\[
f(x) = \alpha_1 + (\alpha_0 - \alpha_1)e^{-\frac{x}{\beta}}
\]</span></p>
<p><span class="math inline">\(\alpha_0\)</span> is the intercept</p>
<p><span class="math inline">\(\alpha_1\)</span> is the lower limit</p>
<p><span class="math inline">\(\beta\)</span> is the “slope”</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># R Code:</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="fu">gnls</span>(y <span class="sc">~</span> a1<span class="sc">+</span>(a0<span class="sc">-</span>a1)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">/</span>b),  </span>
<span id="cb46-3"><a href="#cb46-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb46-4"><a href="#cb46-4"></a>     <span class="at">params =</span> a0 <span class="sc">+</span> a1 <span class="sc">+</span> b <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb46-5"><a href="#cb46-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">a0 =</span> <span class="dv">1</span>, <span class="at">a1 =</span> <span class="fl">0.2</span>, <span class="at">b =</span> <span class="fl">4.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-59-1.png" width="576"></p>
</div>
</div>
</div>
</div>
</section>
<section id="hyperbolic-function" class="slide level2 smaller">
<h2>Hyperbolic Function</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>Equation:</p>
<p><span class="math display">\[
f(x) = \alpha_1 + \frac{\beta*(\alpha_0 - \alpha_1)}{(\beta+x)}
\]</span></p>
<p><span class="math inline">\(\alpha_0\)</span> is the intercept</p>
<p><span class="math inline">\(\alpha_1\)</span> is the lower limit</p>
<p><span class="math inline">\(\beta\)</span> is the “slope”</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># R Code:</span></span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="fu">gnls</span>(y <span class="sc">~</span> a1 <span class="sc">+</span> b<span class="sc">*</span>(a0<span class="sc">-</span>a1)<span class="sc">/</span>(b<span class="sc">+</span>x),  </span>
<span id="cb47-3"><a href="#cb47-3"></a>     <span class="at">data =</span> ag_exp, </span>
<span id="cb47-4"><a href="#cb47-4"></a>     <span class="at">params =</span> a0 <span class="sc">+</span> a1 <span class="sc">+</span> b <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb47-5"><a href="#cb47-5"></a>     <span class="at">start =</span> <span class="fu">c</span>(<span class="at">a0 =</span> <span class="dv">1</span>, <span class="at">a1 =</span> <span class="fl">0.2</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-fig.asp="1">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-61-1.png" width="576"></p>
</div>
</div>
</div>
</div>
</section>
<section id="example-2-herbicide-resistence-in-pigweed" class="slide level2 smaller">
<h2>Example 2: Herbicide Resistence in Pigweed</h2>
<p>The “pigweed” experiment - originally from <span class="citation" data-cites="fergusonALSInhibitorResistance2001">Ferguson, Hamill, and Tardif (<a href="#/references" role="doc-biblioref" onclick="">2001</a>)</span> and republished by <span class="citation" data-cites="bowleyHitchhikerGuideStatistics2015">Bowley (<a href="#/references" role="doc-biblioref" onclick="">2015</a>)</span> - examined the response (as percent survival) exhibited by two biotypes of <em>Amaranthus powellii</em> S. Watson when exposed to increasing doses of the herbicide imazethapyr.</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>pigweed <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-2"><a href="#cb48-2"></a>   <span class="at">Biotype =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">each =</span> <span class="dv">36</span>)),</span>
<span id="cb48-3"><a href="#cb48-3"></a>   <span class="at">Rate =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>,</span>
<span id="cb48-4"><a href="#cb48-4"></a>                  <span class="dv">64</span>, <span class="dv">128</span>, <span class="dv">256</span>, <span class="dv">512</span>),</span>
<span id="cb48-5"><a href="#cb48-5"></a>                <span class="at">each =</span> <span class="dv">4</span>), </span>
<span id="cb48-6"><a href="#cb48-6"></a>            <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.063</span>, <span class="fl">0.125</span>, <span class="fl">0.25</span>,</span>
<span id="cb48-7"><a href="#cb48-7"></a>                  <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">16</span>), </span>
<span id="cb48-8"><a href="#cb48-8"></a>                <span class="at">each =</span> <span class="dv">4</span>)), </span>
<span id="cb48-9"><a href="#cb48-9"></a>   <span class="at">Block =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="dv">18</span>)), </span>
<span id="cb48-10"><a href="#cb48-10"></a>   <span class="at">Pct_Survival =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="cn">NA</span>, </span>
<span id="cb48-11"><a href="#cb48-11"></a>                     <span class="fl">89.44</span>, <span class="fl">61.53</span>, <span class="fl">97.7</span>, <span class="dv">100</span>, <span class="fl">81.74</span>,</span>
<span id="cb48-12"><a href="#cb48-12"></a>                     <span class="fl">61.04</span>, <span class="fl">57.47</span>, <span class="dv">100</span>, <span class="fl">82.42</span>, <span class="fl">73.71</span>,</span>
<span id="cb48-13"><a href="#cb48-13"></a>                     <span class="fl">79.31</span>, <span class="cn">NA</span>, <span class="fl">52.82</span>, <span class="fl">69.51</span>, <span class="fl">66.67</span>,</span>
<span id="cb48-14"><a href="#cb48-14"></a>                     <span class="fl">65.44</span>, <span class="fl">55.38</span>, <span class="fl">51.56</span>, <span class="fl">83.91</span>,</span>
<span id="cb48-15"><a href="#cb48-15"></a>                     <span class="fl">76.5</span>, <span class="fl">43.85</span>, <span class="fl">42.18</span>, <span class="fl">68.97</span>, <span class="cn">NA</span>,</span>
<span id="cb48-16"><a href="#cb48-16"></a>                     <span class="fl">22.44</span>, <span class="fl">34.62</span>, <span class="fl">51.72</span>, <span class="fl">60.14</span>,</span>
<span id="cb48-17"><a href="#cb48-17"></a>                     <span class="fl">14.54</span>, <span class="fl">15.85</span>, <span class="cn">NA</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>,</span>
<span id="cb48-18"><a href="#cb48-18"></a>                     <span class="fl">87.5</span>, <span class="fl">74.3</span>, <span class="fl">97.37</span>, <span class="fl">42.87</span>, <span class="fl">38.28</span>,</span>
<span id="cb48-19"><a href="#cb48-19"></a>                     <span class="fl">50.37</span>, <span class="fl">31.21</span>, <span class="fl">27.17</span>, <span class="fl">42.19</span>, <span class="fl">38.68</span>,</span>
<span id="cb48-20"><a href="#cb48-20"></a>                     <span class="fl">44.3</span>, <span class="fl">45.87</span>, <span class="fl">35.16</span>, <span class="fl">19.65</span>, <span class="fl">28.4</span>,</span>
<span id="cb48-21"><a href="#cb48-21"></a>                     <span class="fl">27.35</span>, <span class="fl">12.5</span>, <span class="fl">14.31</span>, <span class="fl">17.57</span>, <span class="fl">39.44</span>, </span>
<span id="cb48-22"><a href="#cb48-22"></a>                     <span class="fl">7.81</span>, <span class="fl">32.88</span>, <span class="fl">17.63</span>, <span class="fl">22.87</span>, <span class="fl">8.59</span>,</span>
<span id="cb48-23"><a href="#cb48-23"></a>                     <span class="fl">21.87</span>, <span class="fl">19.36</span>, <span class="fl">24.06</span>, <span class="fl">11.72</span>, <span class="fl">3.84</span>, </span>
<span id="cb48-24"><a href="#cb48-24"></a>                     <span class="fl">12.95</span>, <span class="fl">19.89</span>))</span>
<span id="cb48-25"><a href="#cb48-25"></a></span>
<span id="cb48-26"><a href="#cb48-26"></a><span class="fu">str</span>(pigweed, <span class="at">width =</span> <span class="dv">60</span>, <span class="at">strict.width =</span> <span class="st">'cut'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   72 obs. of  4 variables:
 $ Biotype     : Factor w/ 2 levels "A","B": 1 1 1 1 1 1 1..
 $ Rate        : num  1 1 1 1 4 4 4 4 8 8 ...
 $ Block       : Factor w/ 4 levels "1","2","3","4": 1 2 3..
 $ Pct_Survival: num  100 100 100 100 100 ...</code></pre>
</div>
</div>
</div>
</section>
<section id="exploratory-data-analysis-ex.-2" class="slide level2 smaller">
<h2>Exploratory Data Analysis (Ex. 2)</h2>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">ggplot</span>(pigweed, <span class="fu">aes</span>(<span class="at">x =</span> (Rate), <span class="at">y =</span> Pct_Survival, <span class="at">color =</span> Biotype))<span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>  <span class="co"># Plot the data itself</span></span>
<span id="cb50-3"><a href="#cb50-3"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(Biotype), <span class="at">scales =</span> <span class="st">'free'</span>)<span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-63-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="exploratory-data-analysis-ex.-2-1" class="slide level2 smaller">
<h2>Exploratory Data Analysis (Ex. 2)</h2>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb51" data-code-line-numbers="|1-4|8-11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># Define Log-Logistic function</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>loglogistic <span class="ot">=</span> <span class="cf">function</span>(x, ymax, ymin, slope, IC50){</span>
<span id="cb51-3"><a href="#cb51-3"></a>  ymin <span class="sc">+</span> (ymax<span class="sc">-</span>ymin)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>b<span class="sc">*</span>(<span class="fu">log</span>(x)<span class="sc">-</span><span class="fu">log</span>(IC50))))</span>
<span id="cb51-4"><a href="#cb51-4"></a>}</span>
<span id="cb51-5"><a href="#cb51-5"></a></span>
<span id="cb51-6"><a href="#cb51-6"></a><span class="fu">ggplot</span>(pigweed, <span class="fu">aes</span>(<span class="at">x =</span> (Rate), <span class="at">y =</span> Pct_Survival, <span class="at">color =</span> Biotype))<span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7"></a>  <span class="co"># Plot the data itself</span></span>
<span id="cb51-8"><a href="#cb51-8"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(Biotype), <span class="at">scales =</span> <span class="st">'free'</span>)<span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10"></a>  <span class="co"># Plot the log-logistic function</span></span>
<span id="cb51-11"><a href="#cb51-11"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> loglogistic, </span>
<span id="cb51-12"><a href="#cb51-12"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">ymin =</span> <span class="dv">30</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb51-13"><a href="#cb51-13"></a>                            <span class="at">IC50 =</span> <span class="dv">200</span>, <span class="at">slope =</span> <span class="sc">-</span><span class="dv">50</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-64-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="model-development-evaluation-ex.-2" class="slide level2 smaller">
<h2>Model Development &amp; Evaluation (Ex. 2)</h2>
<p>Fit the log-logistic model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" data-code-line-numbers="|1|3-4|5-7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>pigweed_mod_ll <span class="ot">=</span> <span class="fu">gnls</span>(Pct_Survival <span class="sc">~</span> ymin <span class="sc">+</span> (ymax <span class="sc">-</span> ymin)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span> <span class="fu">exp</span>(slope<span class="sc">*</span>(<span class="fu">log</span>(Rate) <span class="sc">-</span> <span class="fu">log</span>(EC50)))),</span>
<span id="cb52-2"><a href="#cb52-2"></a>                      <span class="at">data =</span> pigweed,</span>
<span id="cb52-3"><a href="#cb52-3"></a>                      <span class="at">params =</span> <span class="fu">list</span>(ymin <span class="sc">+</span> ymax <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb52-4"><a href="#cb52-4"></a>                                    slope <span class="sc">+</span> EC50 <span class="sc">~</span> Biotype <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb52-5"><a href="#cb52-5"></a>                      <span class="at">start =</span> <span class="fu">list</span>(<span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb52-6"><a href="#cb52-6"></a>                                   <span class="at">slope =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>), </span>
<span id="cb52-7"><a href="#cb52-7"></a>                                   <span class="at">EC50 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>)),</span>
<span id="cb52-8"><a href="#cb52-8"></a>                      <span class="at">na.action =</span> na.omit)</span>
<span id="cb52-9"><a href="#cb52-9"></a><span class="fu">print</span>(pigweed_mod_ll)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized nonlinear least squares fit
  Model: Pct_Survival ~ ymin + (ymax - ymin)/(1 + exp(slope * (log(Rate) -      log(EC50)))) 
  Data: pigweed 
  Log-likelihood: -273.9753

Coefficients:
          ymin           ymax slope.BiotypeA slope.BiotypeB  EC50.BiotypeA 
   16.38695930   102.71638822     0.57501493     1.19270649    76.73484213 
 EC50.BiotypeB 
    0.08745889 

Degrees of freedom: 68 total; 62 residual
Residual standard error: 14.24344 </code></pre>
</div>
</div>
</section>
<section id="model-development-evaluation-ex.-2-1" class="slide level2 smaller">
<h2>Model Development &amp; Evaluation (Ex. 2)</h2>
<p>Fit the hyperbolic model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54" data-code-line-numbers="|1|3|4-6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>pigweed_mod_hy <span class="ot">=</span> <span class="fu">gnls</span>(Pct_Survival <span class="sc">~</span> ymin <span class="sc">+</span> slope<span class="sc">*</span>(y0 <span class="sc">-</span> ymin)<span class="sc">/</span>(slope<span class="sc">+</span>Rate),</span>
<span id="cb54-2"><a href="#cb54-2"></a>                         <span class="at">data =</span> pigweed,</span>
<span id="cb54-3"><a href="#cb54-3"></a>                         <span class="at">params =</span> <span class="fu">list</span>(ymin <span class="sc">+</span> y0 <span class="sc">+</span> slope <span class="sc">~</span> <span class="dv">0</span><span class="sc">+</span>Biotype),</span>
<span id="cb54-4"><a href="#cb54-4"></a>                         <span class="at">start =</span> <span class="fu">list</span>(<span class="at">ymin =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">7</span>), </span>
<span id="cb54-5"><a href="#cb54-5"></a>                                      <span class="at">y0 =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">100</span>), </span>
<span id="cb54-6"><a href="#cb54-6"></a>                                      <span class="at">slope =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="fl">0.25</span>)),</span>
<span id="cb54-7"><a href="#cb54-7"></a>                         <span class="at">na.action =</span> na.omit)</span>
<span id="cb54-8"><a href="#cb54-8"></a><span class="fu">print</span>(pigweed_mod_hy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized nonlinear least squares fit
  Model: Pct_Survival ~ ymin + slope * (y0 - ymin)/(slope + Rate) 
  Data: pigweed 
  Log-likelihood: -274.9822

Coefficients:
 ymin.BiotypeA  ymin.BiotypeB    y0.BiotypeA    y0.BiotypeB slope.BiotypeA 
   34.21815082    14.56277604    94.52104250   102.68822396    50.30093630 
slope.BiotypeB 
    0.08757621 

Degrees of freedom: 68 total; 62 residual
Residual standard error: 14.45592 </code></pre>
</div>
</div>
</section>
<section id="model-development-evaluation-ex.-2-2" class="slide level2 smaller">
<h2>Model Development &amp; Evaluation (Ex. 2)</h2>
<p>Fit the negative exponential model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" data-code-line-numbers="|1|3|4-6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>pigweed_mod_ne <span class="ot">=</span> <span class="fu">gnls</span>(Pct_Survival <span class="sc">~</span> ymin <span class="sc">+</span> (yinit <span class="sc">-</span> ymin)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>Rate<span class="sc">/</span>slope),</span>
<span id="cb56-2"><a href="#cb56-2"></a>                      <span class="at">data =</span> pigweed,</span>
<span id="cb56-3"><a href="#cb56-3"></a>                      <span class="at">params =</span> <span class="fu">list</span>(yinit <span class="sc">+</span>  ymin <span class="sc">+</span> slope <span class="sc">~</span> <span class="dv">0</span><span class="sc">+</span>Biotype),</span>
<span id="cb56-4"><a href="#cb56-4"></a>                      <span class="at">start =</span> <span class="fu">list</span>(<span class="at">ymin =</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">15</span>), </span>
<span id="cb56-5"><a href="#cb56-5"></a>                                   <span class="at">yinit =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">100</span>), </span>
<span id="cb56-6"><a href="#cb56-6"></a>                                   <span class="at">slope =</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="fl">0.25</span>)),</span>
<span id="cb56-7"><a href="#cb56-7"></a>                      <span class="at">na.action =</span> na.omit)</span>
<span id="cb56-8"><a href="#cb56-8"></a><span class="fu">print</span>(pigweed_mod_ne)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized nonlinear least squares fit
  Model: Pct_Survival ~ ymin + (yinit - ymin) * exp(-Rate/slope) 
  Data: pigweed 
  Log-likelihood: -277.1073

Coefficients:
yinit.BiotypeA yinit.BiotypeB  ymin.BiotypeA  ymin.BiotypeB slope.BiotypeA 
    90.2168592    100.2895962     38.8751801     20.0059165     89.7827055 
slope.BiotypeB 
     0.1316581 

Degrees of freedom: 68 total; 62 residual
Residual standard error: 14.91482 </code></pre>
</div>
</div>
</section>
<section id="model-development-evaluation-ex.-2-3" class="slide level2 smaller">
<h2>Model Development &amp; Evaluation (Ex. 2)</h2>
<p>AIC suggests that the log-logistic is the best fitting model, while visual check of the residuals does not suggest there are violations of the assumptions of normality and homoscedasticity.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">AIC</span>(pigweed_mod_ll, pigweed_mod_hy, pigweed_mod_ne)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               df      AIC
pigweed_mod_ll  7 561.9505
pigweed_mod_hy  7 563.9644
pigweed_mod_ne  7 568.2146</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>pigweed_res <span class="ot">=</span> <span class="fu">resid</span>(pigweed_mod_ll, <span class="at">type =</span> <span class="st">'normalized'</span>)</span>
<span id="cb60-2"><a href="#cb60-2"></a>pigweed_pred <span class="ot">=</span> <span class="fu">fitted</span>(pigweed_mod_ll)</span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="fu">resid_auxpanel</span>(pigweed_res, pigweed_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-70-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</section>
<section id="estimation-inference-and-graphing-ex.-1-3" class="slide level2 smaller">
<h2>Estimation, Inference and Graphing (Ex. 1)</h2>
<p>All the tools from the <code>emmeans</code> package will work with models fit with <code>gnls</code>, you simply need to specify the parameter of interest via the argument <code>param</code>:</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co"># Perform F-Test</span></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="fu">joint_tests</span>(pigweed_mod_ll, <span class="at">param =</span> <span class="st">'EC50'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output cell-output-stdout">
<pre><code> model term df1 df2 F.ratio p.value
 Biotype      1  61   4.702  0.0340</code></pre>
</div>
</div>
</div>
<p><br></p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># Calculate estimated marginal means</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>(<span class="at">pigweed_emm_ll =</span> <span class="fu">emmeans</span>(pigweed_mod_ll, <span class="sc">~</span> Biotype,</span>
<span id="cb63-3"><a href="#cb63-3"></a>                          <span class="at">param =</span> <span class="st">'EC50'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output cell-output-stdout">
<pre><code> Biotype  emmean      SE df lower.CL upper.CL
 A       76.7348 35.3590 61   6.0302  147.439
 B        0.0875  0.0224 61   0.0427    0.132

Confidence level used: 0.95 </code></pre>
</div>
</div>
</div>
<p><br></p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># Perform contrasts, although with only</span></span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="co"># two levels it is unneeded</span></span>
<span id="cb65-3"><a href="#cb65-3"></a><span class="fu">contrast</span>(pigweed_emm_ll, <span class="st">'pairwise'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column fragment">
<div class="cell-output cell-output-stdout">
<pre><code> contrast estimate   SE df t.ratio p.value
 A - B        76.6 35.3 61   2.168  0.0340</code></pre>
</div>
</div>
</div>
</section>
<section id="estimation-inference-and-graphing-ex.-1-4" class="slide level2 smaller">
<h2>Estimation, Inference and Graphing (Ex. 1)</h2>
<p>The <code>marginaleffects</code> package has additional tools for generating estimates and confidence band for the fitted trendline:</p>
<div class="cell" data-layout-align="center" data-fig.asp="0.5">
<div class="sourceCode cell-code" id="cb67" data-code-line-numbers="|1-7|9-13|15-21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># Generate a new data set containing all combinations of </span></span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="co"># Biotype and fine grid of Rate values. Note to remove </span></span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="co"># rows with biotype B and high rates or it messes up</span></span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="co"># plots later</span></span>
<span id="cb67-5"><a href="#cb67-5"></a>toplot <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="at">Biotype =</span> <span class="fu">factor</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb67-6"><a href="#cb67-6"></a>                     <span class="at">Rate =</span> <span class="fu">exp</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">6.9</span>, <span class="fl">6.3</span>, .<span class="dv">1</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb67-7"><a href="#cb67-7"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Biotype <span class="sc">==</span> <span class="st">'B'</span> <span class="sc">&amp;</span> Rate <span class="sc">&gt;</span> <span class="dv">17</span>))</span>
<span id="cb67-8"><a href="#cb67-8"></a></span>
<span id="cb67-9"><a href="#cb67-9"></a><span class="co"># Generate predictions for these new cultivar and density</span></span>
<span id="cb67-10"><a href="#cb67-10"></a><span class="co"># combinations</span></span>
<span id="cb67-11"><a href="#cb67-11"></a>pigweed_preds <span class="ot">=</span> <span class="fu">avg_predictions</span>(<span class="at">model =</span> pigweed_mod_ll, </span>
<span id="cb67-12"><a href="#cb67-12"></a>                                <span class="at">newdata =</span> toplot, </span>
<span id="cb67-13"><a href="#cb67-13"></a>                                <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'Biotype'</span>, <span class="st">'Rate'</span>)) </span>
<span id="cb67-14"><a href="#cb67-14"></a></span>
<span id="cb67-15"><a href="#cb67-15"></a><span class="co"># Plot the results, along with the original data</span></span>
<span id="cb67-16"><a href="#cb67-16"></a><span class="fu">ggplot</span>(pigweed_preds, <span class="fu">aes</span>(<span class="at">x =</span> Rate, <span class="at">color =</span> Biotype, <span class="at">fill =</span> Biotype)) <span class="sc">+</span></span>
<span id="cb67-17"><a href="#cb67-17"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(Biotype), <span class="at">scales =</span> <span class="st">'free'</span>)<span class="sc">+</span></span>
<span id="cb67-18"><a href="#cb67-18"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high),</span>
<span id="cb67-19"><a href="#cb67-19"></a>              <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb67-20"><a href="#cb67-20"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate))<span class="sc">+</span></span>
<span id="cb67-21"><a href="#cb67-21"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Pct_Survival), <span class="at">data =</span> pigweed, <span class="at">size =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section><section id="estimation-inference-and-graphing-ex.-1-4-output" class="slide level2 smaller output-location-slide"><h2>Estimation, Inference and Graphing (Ex. 1)</h2><div class="cell output-location-slide" data-layout-align="center" data-fig.asp="0.5">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Non-Linear-Modeling-for-Rate-Response-Studies-in-Agriculture_files/figure-revealjs/unnamed-chunk-74-1.png" width="960"></p>
</figure>
</div>
</div>
</div></section></section>
<section>
<section id="additional-resources" class="title-slide slide level1 smaller center">
<h1>Additional Resources</h1>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="bolker_cover.jpg" width="300"></p>
<figcaption>Chapter 3: <em>Deterministic Functions for Ecological Modeling</em> provides an excellent, software agnostic introduction to nonlinear models</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="bates_cover.jpg" width="300"></p>
<figcaption>This is the definative reference for the <code>nlme</code> package. Some chapters are highly mathematical, others very much applied. Most examples are not agriculture related, though.</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="glaz_cover.jpg" width="300"></p>
<figcaption>Chapter 15: <em>Nonlinear Regression Models and Applications</em> describes and details a large number the most commonly used nonlinear models in agricultural and related disciplines, and provides example code in R</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="schabenberger_cover.jpg" width="300"></p>
<figcaption>Extended treatment of both mathematical/theorectical and practical aspects of nonlinear modeling in plant and soil sciences, but example code is almost all in SAS</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<div class="footer footer-default">

</div>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-bowleyHitchhikerGuideStatistics2015" class="csl-entry" role="listitem">
Bowley, Stephen R. 2015. <em>Hitchhiker’s <span>Guide</span> to <span>Statistics</span> in <span>Biology</span>: <span>Generalized Linear Mixed Model Edition</span></em>. 1st ed. Kincardine, ON, Canada: Plants et. al.
</div>
<div id="ref-fergusonALSInhibitorResistance2001" class="csl-entry" role="listitem">
Ferguson, Gabrielle M., Allan S. Hamill, and François J. Tardif. 2001. <span>“<span>ALS</span> Inhibitor Resistance in Populations of <span>Powell</span> Amaranth and Redroot Pigweed.”</span> <em>Weed Science</em> 49 (4): 448–53. <a href="https://doi.org/10.1614/0043-1745(2001)049[0448:AIRIPO]2.0.CO;2">https://doi.org/10.1614/0043-1745(2001)049[0448:AIRIPO]2.0.CO;2</a>.
</div>
<div id="ref-meadPlantDensityCrop1970" class="csl-entry" role="listitem">
Mead, R. 1970. <span>“Plant <span>Density</span> and <span>Crop Yield</span>.”</span> <em>Journal of the Royal Statistical Society Series C: Applied Statistics</em> 19 (1): 64–81. <a href="https://doi.org/10.2307/2346843">https://doi.org/10.2307/2346843</a>.
</div>
<div id="ref-schabenbergerContemporaryStatisticalModels2001" class="csl-entry" role="listitem">
Schabenberger, Oliver, and Francis J. Pierce. 2001. <em>Contemporary <span>Statistical Models</span> for the <span>Plant</span> and <span>Soil Sciences</span></em>. CRC Press. <a href="https://books.google.com?id=OyLNBQAAQBAJ">https://books.google.com?id=OyLNBQAAQBAJ</a>.
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Non-Linear Modeling for Rate Response Studies in Agriculture_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: '100%',

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>